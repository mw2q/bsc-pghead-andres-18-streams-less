BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%turquoise%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 260407036.356433
 ALGERIA                   |   1997 | 456538300.295467
 ALGERIA                   |   1996 |     452872935.52
 ALGERIA                   |   1995 | 445608420.153248
 ALGERIA                   |   1994 | 453081039.931981
 ALGERIA                   |   1993 | 442640232.232425
 ALGERIA                   |   1992 | 448848571.854802
 ARGENTINA                 |   1998 | 267172373.382837
 ARGENTINA                 |   1997 | 459862961.140427
 ARGENTINA                 |   1996 |  469551556.14938
 ARGENTINA                 |   1995 | 474361096.852611
 ARGENTINA                 |   1994 | 468035378.640803
 ARGENTINA                 |   1993 | 461122776.026453
 ARGENTINA                 |   1992 |  464923691.63694
 BRAZIL                    |   1998 | 266302980.619869
 BRAZIL                    |   1997 | 464155378.646157
 BRAZIL                    |   1996 | 465905828.036373
 BRAZIL                    |   1995 | 460540936.446452
 BRAZIL                    |   1994 | 462048475.874438
 BRAZIL                    |   1993 | 455702585.830699
 BRAZIL                    |   1992 |  466545064.48111
 CANADA                    |   1998 | 278769548.711478
 CANADA                    |   1997 | 482021767.997809
 CANADA                    |   1996 | 485903496.743963
 CANADA                    |   1995 |  480429299.98424
 CANADA                    |   1994 | 484653742.517506
 CANADA                    |   1993 |  486722720.65531
 CANADA                    |   1992 | 489317472.553712
 CHINA                     |   1998 | 269393021.626453
 CHINA                     |   1997 | 444409830.600655
 CHINA                     |   1996 | 451063249.671787
 CHINA                     |   1995 | 448514286.391428
 CHINA                     |   1994 | 445041052.105401
 CHINA                     |   1993 | 454454275.538207
 CHINA                     |   1992 | 450881210.243035
 EGYPT                     |   1998 |  269241402.07063
 EGYPT                     |   1997 | 466497176.693318
 EGYPT                     |   1996 | 469215975.159994
 EGYPT                     |   1995 |  462936302.54635
 EGYPT                     |   1994 |  457982080.16938
 EGYPT                     |   1993 | 470367652.179902
 EGYPT                     |   1992 | 464084972.719343
 ETHIOPIA                  |   1998 | 264027737.898367
 ETHIOPIA                  |   1997 | 452459721.773009
 ETHIOPIA                  |   1996 | 456266934.082288
 ETHIOPIA                  |   1995 | 457020488.707882
 ETHIOPIA                  |   1994 | 453548656.572887
 ETHIOPIA                  |   1993 | 454910036.354297
 ETHIOPIA                  |   1992 | 460617074.889794
 FRANCE                    |   1998 | 268000675.905232
 FRANCE                    |   1997 | 459296923.921463
 FRANCE                    |   1996 | 464674140.526212
 FRANCE                    |   1995 | 460948595.957836
 FRANCE                    |   1994 | 456758763.801221
 FRANCE                    |   1993 | 462348945.277483
 FRANCE                    |   1992 | 456489184.431737
 GERMANY                   |   1998 | 276741577.680086
 GERMANY                   |   1997 |   474953408.1541
 GERMANY                   |   1996 | 478831246.466458
 GERMANY                   |   1995 | 476611513.499345
 GERMANY                   |   1994 | 474101024.198658
 GERMANY                   |   1993 | 471583003.333136
 GERMANY                   |   1992 | 470331567.598924
 INDIA                     |   1998 | 270199453.349091
 INDIA                     |   1997 | 471823131.293415
 INDIA                     |   1996 | 473569598.868732
 INDIA                     |   1995 | 468762239.639864
 INDIA                     |   1994 |  464633834.67055
 INDIA                     |   1993 | 463413262.143183
 INDIA                     |   1992 | 466352664.325589
 INDONESIA                 |   1998 | 271040702.191712
 INDONESIA                 |   1997 | 458497973.082942
 INDONESIA                 |   1996 | 462648564.708039
 INDONESIA                 |   1995 | 464009004.478058
 INDONESIA                 |   1994 | 461523082.811981
 INDONESIA                 |   1993 | 463819616.332737
 INDONESIA                 |   1992 | 465122477.639689
 IRAN                      |   1998 | 269806104.241542
 IRAN                      |   1997 |  460223033.81786
 IRAN                      |   1996 | 464735943.978636
 IRAN                      |   1995 | 461427645.900451
 IRAN                      |   1994 | 464898518.653511
 IRAN                      |   1993 |  466704658.81391
 IRAN                      |   1992 | 458314932.252726
 IRAQ                      |   1998 | 280181201.750475
 IRAQ                      |   1997 | 476958127.615928
 IRAQ                      |   1996 | 476277333.620936
 IRAQ                      |   1995 | 483737729.455712
 IRAQ                      |   1994 | 483151486.772703
 IRAQ                      |   1993 | 476691464.334671
 IRAQ                      |   1992 | 479940731.878421
 JAPAN                     |   1998 | 270951920.737872
 JAPAN                     |   1997 | 463780891.298373
 JAPAN                     |   1996 | 466738885.180314
 JAPAN                     |   1995 | 465088539.656066
 JAPAN                     |   1994 | 460391664.149523
 JAPAN                     |   1993 | 454515689.196208
 JAPAN                     |   1992 | 456218672.538061
 JORDAN                    |   1998 | 267374416.845137
 JORDAN                    |   1997 | 447349897.582653
 JORDAN                    |   1996 | 452284426.839717
 JORDAN                    |   1995 | 452180433.038528
 JORDAN                    |   1994 | 458139963.253662
 JORDAN                    |   1993 | 456114316.544706
 JORDAN                    |   1992 | 456421579.213575
 KENYA                     |   1998 | 272391375.373414
 KENYA                     |   1997 | 472014927.307982
 KENYA                     |   1996 | 469989784.336516
 KENYA                     |   1995 | 462867808.252667
 KENYA                     |   1994 | 471308377.902594
 KENYA                     |   1993 |  470832415.24322
 KENYA                     |   1992 | 467103741.976251
 MOROCCO                   |   1998 | 269948524.356351
 MOROCCO                   |   1997 | 466639826.779923
 MOROCCO                   |   1996 | 471827353.720304
 MOROCCO                   |   1995 | 467771205.641753
 MOROCCO                   |   1994 | 463486980.640448
 MOROCCO                   |   1993 | 460033884.946425
 MOROCCO                   |   1992 | 470584844.635486
 MOZAMBIQUE                |   1998 | 276600600.677364
 MOZAMBIQUE                |   1997 | 462700845.067555
 MOZAMBIQUE                |   1996 | 462367518.733721
 MOZAMBIQUE                |   1995 | 465430221.205657
 MOZAMBIQUE                |   1994 | 466163820.766715
 MOZAMBIQUE                |   1993 | 468837287.122284
 MOZAMBIQUE                |   1992 | 457949575.043785
 PERU                      |   1998 | 272303559.558376
 PERU                      |   1997 | 462222452.655022
 PERU                      |   1996 | 456977788.623713
 PERU                      |   1995 | 463443797.384037
 PERU                      |   1994 | 465276231.895297
 PERU                      |   1993 | 466696477.572525
 PERU                      |   1992 | 459179504.748631
 ROMANIA                   |   1998 | 271873954.856048
 ROMANIA                   |   1997 | 458974339.101193
 ROMANIA                   |   1996 | 455445553.060125
 ROMANIA                   |   1995 | 465140868.854481
 ROMANIA                   |   1994 | 467106034.317072
 ROMANIA                   |   1993 | 457814146.065473
 ROMANIA                   |   1992 | 469052133.521892
 RUSSIA                    |   1998 | 279532848.103214
 RUSSIA                    |   1997 | 475591170.469618
 RUSSIA                    |   1996 | 471081993.350084
 RUSSIA                    |   1995 | 470142969.821553
 RUSSIA                    |   1994 | 469930690.944978
 RUSSIA                    |   1993 | 472958660.090656
 RUSSIA                    |   1992 | 473015940.515877
 SAUDI ARABIA              |   1998 | 271220682.599407
 SAUDI ARABIA              |   1997 | 466640532.919994
 SAUDI ARABIA              |   1996 | 468669759.763527
 SAUDI ARABIA              |   1995 | 467595280.517921
 SAUDI ARABIA              |   1994 | 469300549.136643
 SAUDI ARABIA              |   1993 | 465449612.055045
 SAUDI ARABIA              |   1992 | 468572047.136394
 UNITED KINGDOM            |   1998 |  269014152.49117
 UNITED KINGDOM            |   1997 | 455843490.269752
 UNITED KINGDOM            |   1996 | 456168850.931208
 UNITED KINGDOM            |   1995 | 458201631.136707
 UNITED KINGDOM            |   1994 | 453502986.855305
 UNITED KINGDOM            |   1993 | 457915100.054907
 UNITED KINGDOM            |   1992 | 461121704.004916
 UNITED STATES             |   1998 | 282559590.990567
 UNITED STATES             |   1997 | 472975456.899125
 UNITED STATES             |   1996 | 482643946.784977
 UNITED STATES             |   1995 | 476962678.573844
 UNITED STATES             |   1994 |  473693456.76411
 UNITED STATES             |   1993 | 475213370.454656
 UNITED STATES             |   1992 | 488515189.778508
 VIETNAM                   |   1998 | 271343050.571778
 VIETNAM                   |   1997 | 464258705.103788
 VIETNAM                   |   1996 | 475655487.780824
 VIETNAM                   |   1995 | 466732549.423607
 VIETNAM                   |   1994 | 466731822.281548
 VIETNAM                   |   1993 | 474143370.849438
 VIETNAM                   |   1992 | 464528198.996997
(175 rows)

COMMIT;
COMMIT
