BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%saddle%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264386316.268431
 ALGERIA                   |   1997 | 457978633.881102
 ALGERIA                   |   1996 | 464664742.518011
 ALGERIA                   |   1995 | 464415590.521876
 ALGERIA                   |   1994 | 466503477.212118
 ALGERIA                   |   1993 | 463111230.032459
 ALGERIA                   |   1992 | 462612250.625078
 ARGENTINA                 |   1998 | 278542635.115094
 ARGENTINA                 |   1997 | 469307480.211451
 ARGENTINA                 |   1996 | 466881504.370788
 ARGENTINA                 |   1995 | 468041457.538578
 ARGENTINA                 |   1994 |  471690388.19946
 ARGENTINA                 |   1993 | 468699901.074184
 ARGENTINA                 |   1992 | 462550233.004496
 BRAZIL                    |   1998 | 277209800.927075
 BRAZIL                    |   1997 | 472774606.608588
 BRAZIL                    |   1996 | 472010422.781681
 BRAZIL                    |   1995 | 467295886.692547
 BRAZIL                    |   1994 | 465899208.812949
 BRAZIL                    |   1993 | 469232223.382516
 BRAZIL                    |   1992 | 469133987.174608
 CANADA                    |   1998 | 272304444.954159
 CANADA                    |   1997 | 474480815.868516
 CANADA                    |   1996 | 475239252.933011
 CANADA                    |   1995 | 480563422.242552
 CANADA                    |   1994 | 475418504.428639
 CANADA                    |   1993 |  485742146.30575
 CANADA                    |   1992 | 479566070.062541
 CHINA                     |   1998 | 274107024.819823
 CHINA                     |   1997 |  466453388.70201
 CHINA                     |   1996 | 461698561.678002
 CHINA                     |   1995 | 468685147.783323
 CHINA                     |   1994 | 465517606.770342
 CHINA                     |   1993 |  464194243.62061
 CHINA                     |   1992 | 468114203.878732
 EGYPT                     |   1998 | 268396079.028399
 EGYPT                     |   1997 | 456019211.486559
 EGYPT                     |   1996 | 458697537.218369
 EGYPT                     |   1995 | 458347380.426751
 EGYPT                     |   1994 | 453828632.068346
 EGYPT                     |   1993 | 466563642.238891
 EGYPT                     |   1992 | 447264848.191694
 ETHIOPIA                  |   1998 | 271260243.022727
 ETHIOPIA                  |   1997 |  466433817.61494
 ETHIOPIA                  |   1996 | 462987811.909886
 ETHIOPIA                  |   1995 | 457606000.333952
 ETHIOPIA                  |   1994 |  464861583.37239
 ETHIOPIA                  |   1993 | 462771243.539559
 ETHIOPIA                  |   1992 | 469561995.251947
 FRANCE                    |   1998 | 267220662.702129
 FRANCE                    |   1997 | 456407809.858967
 FRANCE                    |   1996 |  455685756.14229
 FRANCE                    |   1995 | 461265055.435324
 FRANCE                    |   1994 | 468838717.777484
 FRANCE                    |   1993 | 460459204.831058
 FRANCE                    |   1992 | 461822327.926365
 GERMANY                   |   1998 | 277262759.742593
 GERMANY                   |   1997 | 480930454.108632
 GERMANY                   |   1996 | 480714937.760294
 GERMANY                   |   1995 | 479857619.571929
 GERMANY                   |   1994 | 479523910.939954
 GERMANY                   |   1993 | 483703964.103744
 GERMANY                   |   1992 | 480242117.954429
 INDIA                     |   1998 | 276142451.801679
 INDIA                     |   1997 | 476078212.888394
 INDIA                     |   1996 | 474321724.713625
 INDIA                     |   1995 |  480600854.43016
 INDIA                     |   1994 | 486737496.932711
 INDIA                     |   1993 | 473508432.441478
 INDIA                     |   1992 | 477042620.911386
 INDONESIA                 |   1998 | 269688685.864672
 INDONESIA                 |   1997 | 466050636.024372
 INDONESIA                 |   1996 | 470614026.140727
 INDONESIA                 |   1995 | 466143465.744669
 INDONESIA                 |   1994 | 473203017.251783
 INDONESIA                 |   1993 | 466645415.943549
 INDONESIA                 |   1992 | 469286161.252723
 IRAN                      |   1998 |  264048296.64693
 IRAN                      |   1997 | 455735575.992504
 IRAN                      |   1996 | 458594955.476499
 IRAN                      |   1995 | 459351018.309627
 IRAN                      |   1994 | 451711771.890199
 IRAN                      |   1993 | 453548264.072795
 IRAN                      |   1992 | 459812307.472111
 IRAQ                      |   1998 | 280631809.919701
 IRAQ                      |   1997 | 467827108.926356
 IRAQ                      |   1996 | 471121735.333084
 IRAQ                      |   1995 |   466913478.7255
 IRAQ                      |   1994 | 477276974.924985
 IRAQ                      |   1993 | 472024252.437852
 IRAQ                      |   1992 | 477652727.735993
 JAPAN                     |   1998 | 264789173.520665
 JAPAN                     |   1997 | 465235144.431399
 JAPAN                     |   1996 | 463801727.185967
 JAPAN                     |   1995 | 459878812.980433
 JAPAN                     |   1994 | 462033247.608103
 JAPAN                     |   1993 | 464691731.073934
 JAPAN                     |   1992 | 466129848.512909
 JORDAN                    |   1998 | 273244154.839078
 JORDAN                    |   1997 | 459915353.188449
 JORDAN                    |   1996 | 466686532.899283
 JORDAN                    |   1995 | 461024027.952723
 JORDAN                    |   1994 | 466902256.296332
 JORDAN                    |   1993 | 461288736.530752
 JORDAN                    |   1992 | 459979410.711706
 KENYA                     |   1998 | 267877467.109898
 KENYA                     |   1997 | 462454685.978883
 KENYA                     |   1996 | 469080632.548331
 KENYA                     |   1995 | 470201787.330831
 KENYA                     |   1994 | 462648667.557288
 KENYA                     |   1993 | 469325366.535775
 KENYA                     |   1992 | 473654327.557796
 MOROCCO                   |   1998 | 272006633.275968
 MOROCCO                   |   1997 | 471523439.607434
 MOROCCO                   |   1996 | 465854173.658747
 MOROCCO                   |   1995 | 470645872.532397
 MOROCCO                   |   1994 | 465925039.836766
 MOROCCO                   |   1993 | 470828338.599529
 MOROCCO                   |   1992 | 478034431.171713
 MOZAMBIQUE                |   1998 | 272629436.121777
 MOZAMBIQUE                |   1997 | 463060006.926821
 MOZAMBIQUE                |   1996 | 468025379.697163
 MOZAMBIQUE                |   1995 | 458750327.238618
 MOZAMBIQUE                |   1994 | 464494653.290389
 MOZAMBIQUE                |   1993 |   456745813.0697
 MOZAMBIQUE                |   1992 | 454187398.097548
 PERU                      |   1998 | 277896143.046808
 PERU                      |   1997 | 469713440.226284
 PERU                      |   1996 | 468652269.703396
 PERU                      |   1995 | 467859819.102998
 PERU                      |   1994 | 462862519.709284
 PERU                      |   1993 | 467212119.060011
 PERU                      |   1992 | 464153693.471832
 ROMANIA                   |   1998 | 272759489.074684
 ROMANIA                   |   1997 | 463471811.487514
 ROMANIA                   |   1996 | 471634431.412791
 ROMANIA                   |   1995 | 466069019.705027
 ROMANIA                   |   1994 | 461666295.433801
 ROMANIA                   |   1993 | 458318516.015637
 ROMANIA                   |   1992 | 466939955.111673
 RUSSIA                    |   1998 | 277708891.863019
 RUSSIA                    |   1997 | 474993734.154011
 RUSSIA                    |   1996 | 482082788.743257
 RUSSIA                    |   1995 | 467571700.346705
 RUSSIA                    |   1994 | 476508458.292474
 RUSSIA                    |   1993 | 474293495.285589
 RUSSIA                    |   1992 | 467459490.210091
 SAUDI ARABIA              |   1998 | 278592290.678198
 SAUDI ARABIA              |   1997 | 472503853.182286
 SAUDI ARABIA              |   1996 | 481790666.070745
 SAUDI ARABIA              |   1995 | 474313837.947021
 SAUDI ARABIA              |   1994 | 473647492.682035
 SAUDI ARABIA              |   1993 | 473608826.615116
 SAUDI ARABIA              |   1992 | 474265738.467482
 UNITED KINGDOM            |   1998 | 270557203.344456
 UNITED KINGDOM            |   1997 | 461404786.854521
 UNITED KINGDOM            |   1996 | 470690946.815615
 UNITED KINGDOM            |   1995 | 472108949.272818
 UNITED KINGDOM            |   1994 | 470780229.202579
 UNITED KINGDOM            |   1993 | 471568450.706978
 UNITED KINGDOM            |   1992 | 468508472.712793
 UNITED STATES             |   1998 | 277145568.662647
 UNITED STATES             |   1997 | 472741331.556431
 UNITED STATES             |   1996 | 477720197.222278
 UNITED STATES             |   1995 | 476403615.774768
 UNITED STATES             |   1994 |  484307669.59596
 UNITED STATES             |   1993 | 473822177.279106
 UNITED STATES             |   1992 | 474352259.363034
 VIETNAM                   |   1998 | 276526837.849034
 VIETNAM                   |   1997 | 468689542.971082
 VIETNAM                   |   1996 | 470133901.695778
 VIETNAM                   |   1995 | 468363586.148264
 VIETNAM                   |   1994 | 464446588.428105
 VIETNAM                   |   1993 | 473098284.920116
 VIETNAM                   |   1992 | 470172769.043698
(175 rows)

COMMIT;
COMMIT
