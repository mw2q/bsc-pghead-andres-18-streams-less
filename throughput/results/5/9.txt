BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%papaya%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 263486648.737499
 ALGERIA                   |   1997 | 447304626.548728
 ALGERIA                   |   1996 | 450352490.403916
 ALGERIA                   |   1995 |   451511294.3953
 ALGERIA                   |   1994 | 450550356.248124
 ALGERIA                   |   1993 | 448843923.525407
 ALGERIA                   |   1992 | 460752599.631149
 ARGENTINA                 |   1998 | 276070528.374911
 ARGENTINA                 |   1997 | 466185011.381563
 ARGENTINA                 |   1996 |  469505705.27428
 ARGENTINA                 |   1995 |  462946990.58364
 ARGENTINA                 |   1994 | 459364616.031715
 ARGENTINA                 |   1993 | 461338292.270706
 ARGENTINA                 |   1992 | 474625852.270124
 BRAZIL                    |   1998 |  274521487.73251
 BRAZIL                    |   1997 | 465434158.627807
 BRAZIL                    |   1996 | 466686997.656499
 BRAZIL                    |   1995 | 467694587.961842
 BRAZIL                    |   1994 | 473885331.836554
 BRAZIL                    |   1993 | 470312807.904845
 BRAZIL                    |   1992 | 466206378.480635
 CANADA                    |   1998 | 279754904.224854
 CANADA                    |   1997 | 477122454.198772
 CANADA                    |   1996 | 472652116.355581
 CANADA                    |   1995 | 478385475.873757
 CANADA                    |   1994 | 480110158.688469
 CANADA                    |   1993 | 481821384.685377
 CANADA                    |   1992 | 475542542.327931
 CHINA                     |   1998 | 276276784.991596
 CHINA                     |   1997 | 470081515.709939
 CHINA                     |   1996 | 469423696.905568
 CHINA                     |   1995 |   476116590.9481
 CHINA                     |   1994 |  468935696.11803
 CHINA                     |   1993 |  467144003.18649
 CHINA                     |   1992 | 475243728.038486
 EGYPT                     |   1998 | 268417726.341791
 EGYPT                     |   1997 | 463836897.653497
 EGYPT                     |   1996 |  464419168.95578
 EGYPT                     |   1995 | 458012039.269577
 EGYPT                     |   1994 | 463392053.203786
 EGYPT                     |   1993 | 461357459.573368
 EGYPT                     |   1992 | 462488080.002064
 ETHIOPIA                  |   1998 | 267420599.129947
 ETHIOPIA                  |   1997 | 455324575.376721
 ETHIOPIA                  |   1996 |   448431366.7442
 ETHIOPIA                  |   1995 | 456960194.253885
 ETHIOPIA                  |   1994 | 461615314.002774
 ETHIOPIA                  |   1993 | 448412405.817037
 ETHIOPIA                  |   1992 | 458767476.530637
 FRANCE                    |   1998 |  269487630.06195
 FRANCE                    |   1997 | 460710065.172948
 FRANCE                    |   1996 | 466128392.877881
 FRANCE                    |   1995 | 465301872.768674
 FRANCE                    |   1994 | 451593585.617552
 FRANCE                    |   1993 | 460168125.445408
 FRANCE                    |   1992 | 459415649.417736
 GERMANY                   |   1998 | 278222438.774634
 GERMANY                   |   1997 |  473923445.63733
 GERMANY                   |   1996 | 475042173.863063
 GERMANY                   |   1995 | 478608289.913384
 GERMANY                   |   1994 | 473050683.469136
 GERMANY                   |   1993 | 479221096.799569
 GERMANY                   |   1992 | 472771339.816076
 INDIA                     |   1998 | 274986369.813164
 INDIA                     |   1997 | 472557137.875355
 INDIA                     |   1996 | 468686859.353436
 INDIA                     |   1995 | 468525903.705782
 INDIA                     |   1994 | 474573023.495551
 INDIA                     |   1993 | 467506859.558459
 INDIA                     |   1992 | 464833561.610299
 INDONESIA                 |   1998 | 271367752.593167
 INDONESIA                 |   1997 | 466412816.758618
 INDONESIA                 |   1996 | 469470685.521677
 INDONESIA                 |   1995 | 466130670.791465
 INDONESIA                 |   1994 | 459534331.101011
 INDONESIA                 |   1993 | 476556200.746398
 INDONESIA                 |   1992 |  471296302.13192
 IRAN                      |   1998 |  273829137.17943
 IRAN                      |   1997 | 464792571.922941
 IRAN                      |   1996 | 474700132.531301
 IRAN                      |   1995 |  464392336.05645
 IRAN                      |   1994 | 472653287.650896
 IRAN                      |   1993 | 473433710.777859
 IRAN                      |   1992 | 476703100.009368
 IRAQ                      |   1998 | 276704082.640863
 IRAQ                      |   1997 |  470220297.13602
 IRAQ                      |   1996 | 470430199.589975
 IRAQ                      |   1995 | 468096163.325732
 IRAQ                      |   1994 | 480618989.485381
 IRAQ                      |   1993 | 476369522.107212
 IRAQ                      |   1992 | 469822422.475352
 JAPAN                     |   1998 | 271318934.317757
 JAPAN                     |   1997 | 463134367.215423
 JAPAN                     |   1996 | 473695775.718052
 JAPAN                     |   1995 | 472605624.216272
 JAPAN                     |   1994 | 466388136.371985
 JAPAN                     |   1993 | 470632839.942447
 JAPAN                     |   1992 | 468797532.467746
 JORDAN                    |   1998 | 268284556.595644
 JORDAN                    |   1997 | 460300856.200041
 JORDAN                    |   1996 | 460393763.928156
 JORDAN                    |   1995 | 449330326.231517
 JORDAN                    |   1994 | 459503813.809821
 JORDAN                    |   1993 | 462062324.554746
 JORDAN                    |   1992 | 456075354.089746
 KENYA                     |   1998 | 270654816.632923
 KENYA                     |   1997 | 475834190.453201
 KENYA                     |   1996 | 476157971.312708
 KENYA                     |   1995 | 477553063.473446
 KENYA                     |   1994 | 477234176.551924
 KENYA                     |   1993 | 470523407.400158
 KENYA                     |   1992 | 469616687.470539
 MOROCCO                   |   1998 | 275292152.450611
 MOROCCO                   |   1997 |  460444651.30688
 MOROCCO                   |   1996 | 463409665.195242
 MOROCCO                   |   1995 | 468077950.803761
 MOROCCO                   |   1994 | 462948656.374082
 MOROCCO                   |   1993 | 467164655.779065
 MOROCCO                   |   1992 |  473078226.27335
 MOZAMBIQUE                |   1998 | 261536842.795787
 MOZAMBIQUE                |   1997 |  447212165.95486
 MOZAMBIQUE                |   1996 | 456390715.719248
 MOZAMBIQUE                |   1995 | 462862303.195098
 MOZAMBIQUE                |   1994 |  450614652.06858
 MOZAMBIQUE                |   1993 | 456790558.218256
 MOZAMBIQUE                |   1992 | 448558716.709953
 PERU                      |   1998 | 275268274.461362
 PERU                      |   1997 | 461080263.387344
 PERU                      |   1996 | 465316684.443844
 PERU                      |   1995 |  461219391.10162
 PERU                      |   1994 | 468276621.605447
 PERU                      |   1993 |  459403372.59587
 PERU                      |   1992 | 457465985.039972
 ROMANIA                   |   1998 | 273775319.174165
 ROMANIA                   |   1997 | 461145230.089219
 ROMANIA                   |   1996 | 466736715.705887
 ROMANIA                   |   1995 | 466486826.869542
 ROMANIA                   |   1994 | 463542646.950546
 ROMANIA                   |   1993 | 459924761.681542
 ROMANIA                   |   1992 | 464770173.383242
 RUSSIA                    |   1998 | 275761873.920364
 RUSSIA                    |   1997 | 480178781.922077
 RUSSIA                    |   1996 | 477129826.488302
 RUSSIA                    |   1995 | 468132650.630708
 RUSSIA                    |   1994 |  469732482.43951
 RUSSIA                    |   1993 | 474104037.237124
 RUSSIA                    |   1992 | 475954776.328534
 SAUDI ARABIA              |   1998 | 277979735.367146
 SAUDI ARABIA              |   1997 | 473688906.953173
 SAUDI ARABIA              |   1996 | 478444204.786624
 SAUDI ARABIA              |   1995 | 470002339.714964
 SAUDI ARABIA              |   1994 | 481456072.098317
 SAUDI ARABIA              |   1993 | 471544380.247604
 SAUDI ARABIA              |   1992 | 472484246.349486
 UNITED KINGDOM            |   1998 | 280979887.712431
 UNITED KINGDOM            |   1997 | 467484377.129684
 UNITED KINGDOM            |   1996 | 464824271.910605
 UNITED KINGDOM            |   1995 | 470185379.231829
 UNITED KINGDOM            |   1994 | 463306058.761297
 UNITED KINGDOM            |   1993 | 472689314.905607
 UNITED KINGDOM            |   1992 | 464611550.344618
 UNITED STATES             |   1998 | 273077857.631204
 UNITED STATES             |   1997 | 476405969.560995
 UNITED STATES             |   1996 | 472282117.479579
 UNITED STATES             |   1995 | 477907925.553085
 UNITED STATES             |   1994 | 473898739.992761
 UNITED STATES             |   1993 | 477379960.690056
 UNITED STATES             |   1992 | 468678154.474234
 VIETNAM                   |   1998 | 274664769.914915
 VIETNAM                   |   1997 | 469691894.622931
 VIETNAM                   |   1996 | 470598490.378362
 VIETNAM                   |   1995 | 466261665.260202
 VIETNAM                   |   1994 | 464610059.824891
 VIETNAM                   |   1993 | 474681339.591064
 VIETNAM                   |   1992 | 470394691.700559
(175 rows)

COMMIT;
COMMIT
