BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%navajo%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 272315619.281875
 ALGERIA                   |   1997 | 459031655.724072
 ALGERIA                   |   1996 | 460697094.888482
 ALGERIA                   |   1995 | 463748168.735495
 ALGERIA                   |   1994 | 452188642.184194
 ALGERIA                   |   1993 |  464385492.59494
 ALGERIA                   |   1992 |  463038767.06963
 ARGENTINA                 |   1998 | 281487619.331571
 ARGENTINA                 |   1997 | 473685506.256534
 ARGENTINA                 |   1996 | 474571827.462742
 ARGENTINA                 |   1995 |  473059852.43435
 ARGENTINA                 |   1994 |  476371778.75909
 ARGENTINA                 |   1993 | 477205086.749904
 ARGENTINA                 |   1992 |  474978056.01817
 BRAZIL                    |   1998 |  265688423.35175
 BRAZIL                    |   1997 | 461404289.314141
 BRAZIL                    |   1996 | 465151782.571459
 BRAZIL                    |   1995 | 467450154.829073
 BRAZIL                    |   1994 | 469388195.965352
 BRAZIL                    |   1993 | 470762323.998487
 BRAZIL                    |   1992 | 468566685.764655
 CANADA                    |   1998 | 284532825.139759
 CANADA                    |   1997 | 489509533.725962
 CANADA                    |   1996 | 482684647.578541
 CANADA                    |   1995 | 491161925.155063
 CANADA                    |   1994 |  487233076.38429
 CANADA                    |   1993 | 485350319.157718
 CANADA                    |   1992 | 492128439.912318
 CHINA                     |   1998 |  282125036.94053
 CHINA                     |   1997 | 470257321.362417
 CHINA                     |   1996 | 467305826.901215
 CHINA                     |   1995 | 470732792.553765
 CHINA                     |   1994 | 474909333.767209
 CHINA                     |   1993 | 469700088.751494
 CHINA                     |   1992 | 476528705.533265
 EGYPT                     |   1998 | 271225062.596148
 EGYPT                     |   1997 | 461714227.198815
 EGYPT                     |   1996 | 469164269.735138
 EGYPT                     |   1995 | 460967613.577734
 EGYPT                     |   1994 | 466413648.584964
 EGYPT                     |   1993 | 465364301.221501
 EGYPT                     |   1992 | 463894780.505026
 ETHIOPIA                  |   1998 | 277398055.505014
 ETHIOPIA                  |   1997 | 459465867.928249
 ETHIOPIA                  |   1996 | 458412996.980825
 ETHIOPIA                  |   1995 | 459952918.571838
 ETHIOPIA                  |   1994 | 462543470.883668
 ETHIOPIA                  |   1993 | 469775921.723158
 ETHIOPIA                  |   1992 | 460676062.504935
 FRANCE                    |   1998 | 267924597.307125
 FRANCE                    |   1997 | 456889142.034109
 FRANCE                    |   1996 | 461189327.155394
 FRANCE                    |   1995 | 455465693.282455
 FRANCE                    |   1994 | 461407757.201498
 FRANCE                    |   1993 | 459695001.572102
 FRANCE                    |   1992 | 450142459.374642
 GERMANY                   |   1998 | 279504886.112981
 GERMANY                   |   1997 | 469416668.813514
 GERMANY                   |   1996 | 463508797.132817
 GERMANY                   |   1995 | 468130664.212471
 GERMANY                   |   1994 | 469248236.986051
 GERMANY                   |   1993 | 467784205.318723
 GERMANY                   |   1992 | 470340435.382431
 INDIA                     |   1998 | 278297261.034979
 INDIA                     |   1997 | 483715035.797746
 INDIA                     |   1996 |  486171485.65361
 INDIA                     |   1995 | 478279820.351999
 INDIA                     |   1994 | 480715317.673145
 INDIA                     |   1993 | 486844015.364863
 INDIA                     |   1992 |  480019405.06311
 INDONESIA                 |   1998 | 270716055.107523
 INDONESIA                 |   1997 | 459792944.634654
 INDONESIA                 |   1996 | 474125108.275888
 INDONESIA                 |   1995 |   464845166.5622
 INDONESIA                 |   1994 | 459585980.517699
 INDONESIA                 |   1993 | 469884395.619355
 INDONESIA                 |   1992 | 465524741.990381
 IRAN                      |   1998 | 272757192.236462
 IRAN                      |   1997 |  466326295.26454
 IRAN                      |   1996 | 470908443.941158
 IRAN                      |   1995 | 467624749.417104
 IRAN                      |   1994 | 465323670.679059
 IRAN                      |   1993 | 471696262.259949
 IRAN                      |   1992 | 474863684.065289
 IRAQ                      |   1998 | 280397068.448351
 IRAQ                      |   1997 | 481091987.523888
 IRAQ                      |   1996 | 478651633.180039
 IRAQ                      |   1995 | 479455564.139636
 IRAQ                      |   1994 | 482836681.237815
 IRAQ                      |   1993 | 471926253.741686
 IRAQ                      |   1992 | 480236920.573758
 JAPAN                     |   1998 | 276061545.555403
 JAPAN                     |   1997 | 477909054.967477
 JAPAN                     |   1996 | 476194967.707472
 JAPAN                     |   1995 | 471547628.457389
 JAPAN                     |   1994 | 468204939.519728
 JAPAN                     |   1993 |  469334383.42662
 JAPAN                     |   1992 | 472191971.043983
 JORDAN                    |   1998 | 272099408.142938
 JORDAN                    |   1997 | 465838049.371295
 JORDAN                    |   1996 | 465192680.254731
 JORDAN                    |   1995 | 462498057.333525
 JORDAN                    |   1994 | 456839932.207632
 JORDAN                    |   1993 | 464418246.237847
 JORDAN                    |   1992 | 473900337.728218
 KENYA                     |   1998 | 280655535.588497
 KENYA                     |   1997 | 476243070.824143
 KENYA                     |   1996 | 472249267.554143
 KENYA                     |   1995 | 468996040.343838
 KENYA                     |   1994 |  472296945.26813
 KENYA                     |   1993 | 471847800.499094
 KENYA                     |   1992 | 467994189.425595
 MOROCCO                   |   1998 | 277397672.484833
 MOROCCO                   |   1997 | 473722837.865871
 MOROCCO                   |   1996 | 482153758.001908
 MOROCCO                   |   1995 | 473171147.509031
 MOROCCO                   |   1994 | 469231549.410595
 MOROCCO                   |   1993 | 471618861.473953
 MOROCCO                   |   1992 | 477290226.674554
 MOZAMBIQUE                |   1998 | 270981238.756036
 MOZAMBIQUE                |   1997 | 458426770.142512
 MOZAMBIQUE                |   1996 | 466384232.630207
 MOZAMBIQUE                |   1995 |  471705623.06304
 MOZAMBIQUE                |   1994 | 460775127.759751
 MOZAMBIQUE                |   1993 | 462514564.948457
 MOZAMBIQUE                |   1992 | 461662456.452402
 PERU                      |   1998 | 281610073.837986
 PERU                      |   1997 | 471761555.434139
 PERU                      |   1996 | 472259716.507741
 PERU                      |   1995 | 474720905.571685
 PERU                      |   1994 |  471014297.20598
 PERU                      |   1993 | 469075006.815069
 PERU                      |   1992 | 472429911.198193
 ROMANIA                   |   1998 |  282978588.30937
 ROMANIA                   |   1997 | 472063563.253142
 ROMANIA                   |   1996 | 478697029.867781
 ROMANIA                   |   1995 |  473029195.72795
 ROMANIA                   |   1994 | 477087071.610705
 ROMANIA                   |   1993 | 475925228.312109
 ROMANIA                   |   1992 | 474529237.562666
 RUSSIA                    |   1998 | 279057417.310092
 RUSSIA                    |   1997 | 477930017.985373
 RUSSIA                    |   1996 | 482792678.673219
 RUSSIA                    |   1995 | 486060199.313298
 RUSSIA                    |   1994 |  482686832.80034
 RUSSIA                    |   1993 | 479431211.326378
 RUSSIA                    |   1992 | 482558914.685058
 SAUDI ARABIA              |   1998 | 282166804.149935
 SAUDI ARABIA              |   1997 | 465599056.367902
 SAUDI ARABIA              |   1996 | 474229981.722131
 SAUDI ARABIA              |   1995 | 472266263.482614
 SAUDI ARABIA              |   1994 | 470956319.076003
 SAUDI ARABIA              |   1993 | 465458899.762355
 SAUDI ARABIA              |   1992 | 462185620.754762
 UNITED KINGDOM            |   1998 | 264907476.526291
 UNITED KINGDOM            |   1997 | 467050901.274496
 UNITED KINGDOM            |   1996 | 456344151.906052
 UNITED KINGDOM            |   1995 | 460692964.922615
 UNITED KINGDOM            |   1994 | 456249968.614049
 UNITED KINGDOM            |   1993 | 451084416.135689
 UNITED KINGDOM            |   1992 | 454488332.570761
 UNITED STATES             |   1998 | 280178118.955586
 UNITED STATES             |   1997 | 473653654.335835
 UNITED STATES             |   1996 | 479387231.816386
 UNITED STATES             |   1995 | 473264513.215488
 UNITED STATES             |   1994 | 479553544.800855
 UNITED STATES             |   1993 | 475856286.263307
 UNITED STATES             |   1992 |  475500446.10333
 VIETNAM                   |   1998 | 266660703.241567
 VIETNAM                   |   1997 |  458810424.78989
 VIETNAM                   |   1996 | 474156122.635607
 VIETNAM                   |   1995 | 465275767.347074
 VIETNAM                   |   1994 | 468523545.941663
 VIETNAM                   |   1993 | 463741805.872836
 VIETNAM                   |   1992 | 460789325.199266
(175 rows)

COMMIT;
COMMIT
