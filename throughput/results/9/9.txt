BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%indian%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264205072.601408
 ALGERIA                   |   1997 | 464360769.128598
 ALGERIA                   |   1996 | 455276380.670767
 ALGERIA                   |   1995 | 467272295.588289
 ALGERIA                   |   1994 | 454886972.313168
 ALGERIA                   |   1993 | 462739633.943417
 ALGERIA                   |   1992 |  462973115.35251
 ARGENTINA                 |   1998 | 271129868.377017
 ARGENTINA                 |   1997 | 469167428.668706
 ARGENTINA                 |   1996 | 468557273.500994
 ARGENTINA                 |   1995 | 463954304.017626
 ARGENTINA                 |   1994 |  465096375.67687
 ARGENTINA                 |   1993 |  458575753.25262
 ARGENTINA                 |   1992 | 456316160.170386
 BRAZIL                    |   1998 | 278993178.649197
 BRAZIL                    |   1997 | 464965489.723018
 BRAZIL                    |   1996 | 469788058.251422
 BRAZIL                    |   1995 | 462763332.053651
 BRAZIL                    |   1994 | 465784985.142856
 BRAZIL                    |   1993 | 464989341.613444
 BRAZIL                    |   1992 | 475759713.116636
 CANADA                    |   1998 | 274822786.795695
 CANADA                    |   1997 | 483879113.546195
 CANADA                    |   1996 | 485251780.973289
 CANADA                    |   1995 | 485132914.031259
 CANADA                    |   1994 | 485623442.773068
 CANADA                    |   1993 | 488507158.237792
 CANADA                    |   1992 | 474888749.252548
 CHINA                     |   1998 | 273075970.204163
 CHINA                     |   1997 | 463285317.544798
 CHINA                     |   1996 | 466034962.452069
 CHINA                     |   1995 | 463837527.084532
 CHINA                     |   1994 | 462434082.854823
 CHINA                     |   1993 | 466973630.071373
 CHINA                     |   1992 | 463361244.315172
 EGYPT                     |   1998 |  269286463.35602
 EGYPT                     |   1997 | 463203825.973303
 EGYPT                     |   1996 | 466667984.896281
 EGYPT                     |   1995 | 465431121.801677
 EGYPT                     |   1994 |   455967300.0182
 EGYPT                     |   1993 | 476308737.255859
 EGYPT                     |   1992 | 468053648.946011
 ETHIOPIA                  |   1998 | 273050099.867622
 ETHIOPIA                  |   1997 | 463024683.258092
 ETHIOPIA                  |   1996 | 451029606.003163
 ETHIOPIA                  |   1995 | 465377636.261922
 ETHIOPIA                  |   1994 | 462233662.820109
 ETHIOPIA                  |   1993 | 458761213.453676
 ETHIOPIA                  |   1992 | 465054918.063218
 FRANCE                    |   1998 | 268666549.116042
 FRANCE                    |   1997 | 463547108.457997
 FRANCE                    |   1996 |  470484177.80875
 FRANCE                    |   1995 | 466154785.732245
 FRANCE                    |   1994 |  466663978.26675
 FRANCE                    |   1993 | 468216537.709336
 FRANCE                    |   1992 | 463723967.381126
 GERMANY                   |   1998 | 281526230.856359
 GERMANY                   |   1997 | 470242717.172727
 GERMANY                   |   1996 | 478547739.584237
 GERMANY                   |   1995 | 468882818.304779
 GERMANY                   |   1994 | 474698058.166856
 GERMANY                   |   1993 | 476092892.065024
 GERMANY                   |   1992 | 480952534.952127
 INDIA                     |   1998 | 276076123.195236
 INDIA                     |   1997 | 473581271.693752
 INDIA                     |   1996 | 471886090.293092
 INDIA                     |   1995 | 476701211.995576
 INDIA                     |   1994 | 476201271.269683
 INDIA                     |   1993 | 468675572.700878
 INDIA                     |   1992 | 469027793.559154
 INDONESIA                 |   1998 | 273164771.934846
 INDONESIA                 |   1997 | 454462262.112794
 INDONESIA                 |   1996 | 467419963.466551
 INDONESIA                 |   1995 | 466998406.146463
 INDONESIA                 |   1994 | 460926931.483049
 INDONESIA                 |   1993 | 472825954.153445
 INDONESIA                 |   1992 | 465532495.407029
 IRAN                      |   1998 | 272074286.326327
 IRAN                      |   1997 | 456588996.451441
 IRAN                      |   1996 | 458400389.915057
 IRAN                      |   1995 | 464696671.571598
 IRAN                      |   1994 |  462330493.09302
 IRAN                      |   1993 | 453446487.464279
 IRAN                      |   1992 |  454772521.94576
 IRAQ                      |   1998 | 277979652.776716
 IRAQ                      |   1997 | 474093073.900346
 IRAQ                      |   1996 | 467054072.554235
 IRAQ                      |   1995 | 469445835.660474
 IRAQ                      |   1994 | 475227384.496148
 IRAQ                      |   1993 | 466591848.878856
 IRAQ                      |   1992 | 468219249.047055
 JAPAN                     |   1998 | 267996369.702451
 JAPAN                     |   1997 |  464250330.03783
 JAPAN                     |   1996 | 460409331.201994
 JAPAN                     |   1995 |  467940108.42371
 JAPAN                     |   1994 |  462787614.48973
 JAPAN                     |   1993 | 466688489.705247
 JAPAN                     |   1992 | 465682900.004486
 JORDAN                    |   1998 | 264387442.875062
 JORDAN                    |   1997 | 456179815.139629
 JORDAN                    |   1996 | 458113309.826153
 JORDAN                    |   1995 | 456878610.441935
 JORDAN                    |   1994 | 455702192.483623
 JORDAN                    |   1993 | 453439495.008906
 JORDAN                    |   1992 | 459370731.549251
 KENYA                     |   1998 | 277239634.970588
 KENYA                     |   1997 | 473424608.703707
 KENYA                     |   1996 | 471994299.111856
 KENYA                     |   1995 | 469254980.773674
 KENYA                     |   1994 |  466310100.11689
 KENYA                     |   1993 | 462921560.725401
 KENYA                     |   1992 | 466682610.939067
 MOROCCO                   |   1998 | 275719289.103391
 MOROCCO                   |   1997 | 466473018.646261
 MOROCCO                   |   1996 | 470000336.339885
 MOROCCO                   |   1995 | 467039287.032636
 MOROCCO                   |   1994 | 468996027.330322
 MOROCCO                   |   1993 | 480394684.752045
 MOROCCO                   |   1992 |   463446420.1509
 MOZAMBIQUE                |   1998 | 273688951.592033
 MOZAMBIQUE                |   1997 | 460541204.935763
 MOZAMBIQUE                |   1996 | 463736481.185494
 MOZAMBIQUE                |   1995 | 463181655.593286
 MOZAMBIQUE                |   1994 |  459408601.07973
 MOZAMBIQUE                |   1993 | 460185196.537277
 MOZAMBIQUE                |   1992 | 462237644.288398
 PERU                      |   1998 |  276972443.83877
 PERU                      |   1997 | 475795034.985605
 PERU                      |   1996 | 466833480.873047
 PERU                      |   1995 | 468017149.849626
 PERU                      |   1994 | 461041062.211934
 PERU                      |   1993 | 472572079.443897
 PERU                      |   1992 | 474155483.036689
 ROMANIA                   |   1998 | 275887799.108377
 ROMANIA                   |   1997 | 465782587.017067
 ROMANIA                   |   1996 | 457779325.082817
 ROMANIA                   |   1995 | 468619694.329054
 ROMANIA                   |   1994 | 468358171.713348
 ROMANIA                   |   1993 | 465488059.567206
 ROMANIA                   |   1992 | 461945801.215601
 RUSSIA                    |   1998 |  284454221.44991
 RUSSIA                    |   1997 | 473042635.995915
 RUSSIA                    |   1996 | 484445483.267316
 RUSSIA                    |   1995 |  467944714.52765
 RUSSIA                    |   1994 | 476372824.791324
 RUSSIA                    |   1993 |  469954331.35084
 RUSSIA                    |   1992 | 470183608.024185
 SAUDI ARABIA              |   1998 | 272884767.428941
 SAUDI ARABIA              |   1997 | 466846492.675572
 SAUDI ARABIA              |   1996 | 470649979.353021
 SAUDI ARABIA              |   1995 | 467318265.124915
 SAUDI ARABIA              |   1994 | 469059125.204022
 SAUDI ARABIA              |   1993 | 469197182.944997
 SAUDI ARABIA              |   1992 | 469396170.582055
 UNITED KINGDOM            |   1998 | 277040112.462111
 UNITED KINGDOM            |   1997 | 467715957.014888
 UNITED KINGDOM            |   1996 |  475701821.03168
 UNITED KINGDOM            |   1995 | 471762433.836438
 UNITED KINGDOM            |   1994 | 464780937.898401
 UNITED KINGDOM            |   1993 | 476627507.659318
 UNITED KINGDOM            |   1992 | 459352725.708941
 UNITED STATES             |   1998 | 274969540.477515
 UNITED STATES             |   1997 | 467286110.390377
 UNITED STATES             |   1996 | 470071411.720746
 UNITED STATES             |   1995 | 464163032.181834
 UNITED STATES             |   1994 |   469859469.6934
 UNITED STATES             |   1993 | 464473156.595246
 UNITED STATES             |   1992 | 467528046.314798
 VIETNAM                   |   1998 | 265752418.944484
 VIETNAM                   |   1997 | 458845134.040371
 VIETNAM                   |   1996 | 462505425.814523
 VIETNAM                   |   1995 | 458575035.622167
 VIETNAM                   |   1994 | 464868741.625702
 VIETNAM                   |   1993 | 461839788.655939
 VIETNAM                   |   1992 | 457315104.172017
(175 rows)

COMMIT;
COMMIT
